---
import BaseLayout from '@layouts/BaseLayout.astro';
import { createSupabaseServerClient } from '@backend/supabaseServerClient';
import { getLangFromUrl, getTranslations } from '@i18n';
import { ImageAnnotationDesktop } from '@apps/annotation-image';

const lang = getLangFromUrl(Astro.url);

const supabase = await createSupabaseServerClient(Astro.request, Astro.cookies);
if (!supabase)
  return Astro.redirect(`/${lang}/sign-in`);

// For now, we'll accept either 'image or 'text' as a dummy-slug
const slug = Astro.params.slug;
---
<BaseLayout title="Annotation">
  <div class="container">
    {slug === 'image' ? (
      <ImageAnnotationDesktop 
        client:only
        i18n={getTranslations(Astro.request, 'annotation-image')}/>
    ) : (
      <div>Text Annotation</div>
    )}
  </div>
</BaseLayout>

<style>
  .container {
    bottom: 0;
    left: 0;
    overflow: hidden;
    position: absolute;
    right: 0;
    top: 0;
  }
</style>